!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"undefined"!=typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){"use strict";t.fn.priceFormat=function(n){var n=t.extend(!0,{},t.fn.priceFormat.defaults,n);"function"==typeof n.callback&&n.callback(this),window.ctrl_down=!1;var i=!1;return t(window).bind("keyup keydown",function(t){return window.ctrl_down=t.ctrlKey,!0}),t(this).bind("keyup keydown",function(t){return i=t.metaKey,!0}),this.each(function(){function r(t){h.is("input")?h.val(t):h.html(t),h.trigger("pricechange")}function e(){return m=h.is("input")?h.val():h.html()}function o(t){for(var n="",i=0;i<t.length;i++){var r=t.charAt(i);0==n.length&&0==r&&(r=!1),r&&r.match(v)&&(k?n.length<k&&(n+=r):n+=r)}return n}function a(t){for(;t.length<_+1;)t="0"+t;return t}function f(n,i){if(!i&&(""===n||n==f("0",!0))&&C)return"";var r=a(o(n)),e="",u=0;0==_&&(w="",c="");var c=r.substr(r.length-_,_),s=r.substr(0,r.length-_);if(r=N?s+w+c:"0"!==s?s+w+c:w+c,x||""!=t.trim(x)){for(var l=s.length;l>0;l--){var d=s.substr(l-1,1);u++,u%3==0&&(d=x+d),e=d+e}e.substr(0,1)==x&&(e=e.substring(1,e.length)),r=0==_?e:e+w+c}return!O||0==s&&0==c||(r=-1!=n.indexOf("-")&&n.indexOf("+")<n.indexOf("-")?"-"+r:P?"+"+r:""+r),g&&(r=g+r),b&&(r+=b),r}function u(t){var n=t.keyCode?t.keyCode:t.which,e=String.fromCharCode(n),o=!1,a=m,u=f(a+e);(n>=48&&57>=n||n>=96&&105>=n)&&(o=!0),192==n&&(o=!0),8==n&&(o=!0),9==n&&(o=!0),13==n&&(o=!0),46==n&&(o=!0),37==n&&(o=!0),39==n&&(o=!0),!O||189!=n&&109!=n&&173!=n||(o=!0),!P||187!=n&&107!=n&&61!=n||(o=!0),n>=16&&20>=n&&(o=!0),27==n&&(o=!0),n>=33&&40>=n&&(o=!0),n>=44&&46>=n&&(o=!0),(window.ctrl_down||i)&&(86==n&&(o=!0),67==n&&(o=!0),88==n&&(o=!0),82==n&&(o=!0),84==n&&(o=!0),76==n&&(o=!0),87==n&&(o=!0),81==n&&(o=!0),78==n&&(o=!0),65==n&&(o=!0)),o||(t.preventDefault(),t.stopPropagation(),a!=u&&r(u))}function c(){var t=e(),n=f(t);t!=n&&r(n);var i=f("0",!0);n==i&&"0"!=t&&C&&r(""),y&&y()}function s(){h.val(g+e())}function l(){h.val(e()+b)}function d(){if(""!=t.trim(g)&&S){var n=e().split(g);r(n[1])}}function p(){if(""!=t.trim(b)&&F){var n=e().split(b);r(n[0])}}var h=t(this),m="",v=/[0-9]/;m=h.is("input")?h.val():h.html();var g=n.prefix,y=n.afterMethod,b=n.suffix,w=n.centsSeparator,x=n.thousandsSeparator,k=n.limit,_=n.centsLimit,S=n.clearPrefix,F=n.clearSuffix,O=n.allowNegative,P=n.insertPlusSign,C=n.clearOnEmpty,N=n.leadingZero;P&&(O=!0),h.bind("keydown.price_format",u),h.bind("keyup.price_format",c),h.bind("focusout.price_format",c),S&&(h.bind("focusout.price_format",function(){d()}),h.bind("focusin.price_format",function(){s()})),F&&(h.bind("focusout.price_format",function(){p()}),h.bind("focusin.price_format",function(){l()})),e().length>0&&(c(),d(),p())})},t.fn.unpriceFormat=function(){return t(this).unbind(".price_format")},t.fn.unmask=function(){var n,i="";n=t(this).is("input")?t(this).val()||[]:t(this).html();for(var r=0;r<n.length;r++)isNaN(n[r])&&"-"!=n[r]||(i+=n[r]);return i},t.fn.priceToFloat=function(){var n;return n=t(this).is("input")?t(this).val()||[]:t(this).html(),parseFloat(n.replace(/[^0-9\-\.]/g,""))},t.fn.priceFormat.defaults={prefix:"US$ ",suffix:"",centsSeparator:".",thousandsSeparator:",",limit:!1,centsLimit:2,clearPrefix:!1,afterMethod:"",clearSufix:!1,allowNegative:!1,insertPlusSign:!1,clearOnEmpty:!1,leadingZero:!0}});

